<?xml version="1.0"?>
<rules version="2011.1" author="andi">
	<!-- Attributes -->
	<attr name="buildingH" value="27"/>
	<attr name="floorH" value="3.5"/>
	<attr name="groundflH" value="4.5"/>
	<attr name="nSymmetries" value="2"/>
	<attr name="borderwallW" value="0.3"/>
	<attr name="ledgeH" value="0.3"/>
	<attr name="windowW" value="2.5"/>
	<attr name="milkGlassW" value="1.25"/>
	<attr name="blindH" value="0.8"/>
	<attr name="frameW" value="0.07"/>
	<attr name="balconyDepth" value="2"/>
	<attr name="brightblue" value="#86b1c7"/>
	<attr name="darkblue" value="#33556c"/>
	<attr name="red" value="#5c3f40"/>
	<attr name="grey" value="#6b7785"/>
	<attr name="white" value="#ffffff"/>

	<attr name="tileW" value="3.75"/>
	<attr name="barDiameter" value="0.04"/>
	
	<!-- Assets -->
	<attr name="cyl_v" value="../assets/primitives/cylinder.vert.8.notop.tex.obj"/>
	<attr name="cyl_h" value="../assets/primitives/cylinder.hor.8.notop.tex.obj"/>
	<attr name="window_tex" value="../assets/textures/1_glass_2_blue.tif"/>
	<attr name="milkGlass_tex" value="../assets/textures/blend_tex.png"/>
	<attr name="cube" value="../assets/primitives/cube.obj"/>
	
	<!-- Volume -->
	<rule name="Lot">
		<operator name="extrude">
			<param name="height" value="buildingH"/>
		</operator>
		<operator name="split">
			<param name="splitAxis" value="z"/>
			<param name="size">
				<element type="floating" value="1"/>
				<element type="absolute" value="floorH"/>
			</param>
			<param name="name">
				<element value="MainPart"/>
				<element value="UpperPart"/>
			</param>
		</operator>
	</rule>
	
	<rule name="UpperPart">
		<operator name="split">
			<param name="splitAxis" value="y"/>
			<param name="size">
				<element type="absolute" value="balconyDepth"/>
				<element type="floating" value="1"/>
			</param>
			<param name="name">
				<element value="Balcony"/>
				<element value="TopFloor"/>
			</param>
		</operator>
	</rule>
	
	<rule name="MainPart">
		<operator name="comp">
			<param name="front" value="Facade"/>
			<param name="side" value="Wall"/>
			<param name="top" value="Roof."/>
		</operator>
	</rule>
	
	<rule name="TopFloor">
		<operator name="comp">
			<param name="front" value="Floor"/>
			<param name="side" value="Wall"/>
			<param name="top" value="Roof."/>
		</operator>
	</rule>
	
	<rule name="Balcony">
		<operator name="size">
			<param name="xSize" type="absolute" value="scope.sx-2*borderwallW"/>
			<param name="ySize" type="absolute" value="scope.sy-borderwallW"/>
			<param name="zSize" type="absolute" value="0.7"/>
		</operator>
		<operator name="translate">
			<param name="mode" value="rel"/>
			<param name="coordSystem" value="object"/>
			<param name="x" value="borderwallW"/>
			<param name="y" value="borderwallW"/>
			<param name="z" value="0"/>
		</operator>
		<operator name="comp">
			<param name="front" value="Railing"/>
			<param name="left" value="Railing"/>
			<param name="right" value="Railing"/>
		</operator>
	</rule>

	<!-- Facade and Floors -->
	<rule name="Facade">
		<operator name="split">
			<param name="splitAxis" value="y"/>
			<param name="size">
				<element type="floating" value="groundflH"/>
				<element type="floating" value="floorH" repeat="true"/>
			</param>
			<param name="name">
				<element value="Floor"/>
				<element value="Floor"/>
			</param>
		</operator>
	</rule>
	<rule name="Floor">
		<operator name="split">
			<param name="splitAxis" value="x"/>
			<param name="size">
				<element type="absolute" value="borderwallW"/>
				<element type="floating" value="1"/>
				<element type="absolute" value="borderwallW"/>
			</param>
			<param name="name">
				<element value="Wall"/>
				<element value="FloorSub"/>
				<element value="Wall"/>
			</param>
		</operator>
	</rule>
	<rule name="FloorSub">
		<operator name="split">
			<param name="splitAxis" value="y"/>
			<param name="size">
				<element type="floating" value="1"/>
				<element type="absolute" value="ledgeH"/>
			</param>
			<param name="name">
				<element value="TileRow"/>
				<element value="Ledge"/>
			</param>
		</operator>
	</rule>
	
	<!-- Tiles -->
	<rule name="TileRow">
		<operator name="split">
			<param name="splitAxis" value="x"/>
			<param name="size">
				<element type="floating" value="tileW*nSymmetries" repeat="true"/>
			</param>
			<param name="name">
				<element value="DoubleTile"/>
			</param>
		</operator>
	</rule>
	<rule name="DoubleTile">
		<operator name="split">
			<param name="splitAxis" value="x"/>
			<param name="size">
				<element type="floating" value="milkGlassW+windowW" repeat="true"/>
			</param>
			<param name="name">
				<element value="MilkGlassAndTile"/>
			</param>
		</operator>
	</rule>
	<rule name="MilkGlassAndTile">
		<operator name="split">
			<param name="splitAxis" value="x"/>
			<param name="size">
				<element type="floating" value="milkGlassW"/>
				<element type="floating" value="windowW"/>
			</param>
			<param name="name">
				<element value="MilkGlass"/>
				<element value="Tile"/>
			</param>
		</operator>
	</rule>
	<rule name="Tile">
		<operator name="setupProjection">
			<param name="axesSelector" value="scope.xy"/>
			<param name="texWidth" type="absolute" value="scope.sx"/>
			<param name="texHeight" type="absolute" value="scope.sy"/>
		</operator>
		<operator name="split">
			<param name="splitAxis" value="x"/>
			<param name="size">
				<element type="absolute" value="frameW"/>
				<element type="floating" value="1"/>
				<element type="absolute" value="frameW"/>
			</param>
			<param name="name">
				<element value="FrameAndBracing"/>
				<element value="FrameAndBlind"/>
				<element value="FrameAndBracing"/>
			</param>
		</operator>
	</rule>
	<rule name="FrameAndBracing">
		<operator name="copy">
			<param name="name" value="Frame"/>
		</operator>
		<operator name="copy">
			<param name="name" value="Bracing"/>
		</operator>
	</rule>
	<rule name="FrameAndBlind">
		<operator name="split">
			<param name="splitAxis" value="y"/>
			<param name="size">
				<element type="absolute" value="frameW"/>
				<element type="floating" value="1"/>
				<element type="absolute" value="frameW"/>
				<element type="absolute" value="blindH"/>
				<element type="absolute" value="frameW"/>
			</param>
			<param name="name">
				<element value="Frame"/>
				<element value="Window"/>
				<element value="Frame"/>
				<element value="Blind"/>
				<element value="Frame"/>
			</param>
		</operator>
	</rule>
	
	<!-- Windows -->
	<rule name="Window">
		<operator name="split">
			<param name="splitAxis" value="x"/>
			<param name="size">
				<element type="floating" value="1"/>
				<element type="absolute" value="frameW"/>
				<element type="floating" value="1"/>
			</param>
			<param name="name">
				<element value="Subwindow"/>
				<element value="Frame"/>
				<element value="Glass"/>
			</param>
		</operator>
	</rule>
	<rule name="Subwindow">
		<operator name="split">
			<param name="splitAxis" value="x"/>
			<param name="size">
				<element type="floating" value="2"/>
				<element type="floating" value="3"/>
			</param>
			<param name="name">
				<element value="Glass"/>
				<element value="RedWindow"/>
			</param>
		</operator>
	</rule>
	<rule name="RedWindow">
		<operator name="split">
			<param name="splitAxis" value="x"/>
			<param name="size">
				<element type="absolute" value="frameW"/>
				<element type="floating" value="1"/>
			</param>
			<param name="name">
				<element value="RedFrame"/>
				<element value="RedFrameAndGlass"/>
			</param>
		</operator>
	</rule>
	<rule name="RedFrameAndGlass">
		<operator name="split">
			<param name="splitAxis" value="y"/>
			<param name="size">
				<element type="absolute" value="frameW"/>
				<element type="floating" value="1"/>
				<element type="absolute" value="frameW"/>
			</param>
			<param name="name">
				<element value="RedFrame"/>
				<element value="RedGlass"/>
				<element value="RedFrame"/>
			</param>
		</operator>
	</rule>
	<rule name="RedGlass">
		<operator name="split">
			<param name="splitAxis" value="y"/>
			<param name="size">
				<element type="floating" value="1"/>
				<element type="floating" value="frameW/2"/>
				<element type="floating" value="1"/>
			</param>
			<param name="name">
				<element value="Glass"/>
				<element value="Frame"/>
				<element value="Glass"/>
			</param>
		</operator>
	</rule>
	
	<!-- Materials -->
	<rule name="Wall">
		<operator name="color">
			<param name="s" value="darkblue"/>
		</operator>
	</rule>
	<rule name="Blind">
		<operator name="color">
			<param name="s" value="grey"/>
		</operator>
	</rule>
	<rule name="Frame">
		<operator name="extrude">
			<param name="height" value="frameW"/>
		</operator>
		<operator name="color">
			<param name="s" value="white"/>
		</operator>
	</rule>
	<rule name="RedFrame">
		<operator name="translate">
			<param name="mode" value="rel"/>
			<param name="coordSystem" value="object"/>
			<param name="x" value="0"/>
			<param name="y" value="0"/>
			<param name="z" value="-frameW"/>
		</operator>
		<operator name="extrude">
			<param name="height" value="frameW*4"/>
		</operator>
		<operator name="color">
			<param name="s" value="red"/>
		</operator>
	</rule>
	<rule name="Glass">
		<operator name="texture">
			<param name="texture" value="window_tex"/>
		</operator>
		<operator name="color">
			<param name="s" value="white"/>
		</operator>
	</rule>
	<rule name="MilkGlass">
		<operator name="size">
			<param name="xSize" type="relative" value="1"/>
			<param name="ySize" type="relative" value="1"/>
			<param name="zSize" type="absolute" value="frameW*1.2"/>
		</operator>
		<operator name="insert">
			<param name="geometryPath" value="cube"/>
		</operator>
		<operator name="color">
			<param name="s" value="brightblue"/>
		</operator>
		<!--
		<operator name="setupProjection">
			<param name="axesSelector" value="scope.xy"/>
			<param name="texWidth" type="absolute" value="scope.sx"/>
			<param name="texHeight" type="absolute" value="scope.sy"/>
		</operator>
		-->
		<operator name="texture">
			<param name="texture" value="milkGlass_tex"/>
		</operator>
	</rule>
	
	<!-- Detail Elements -->
	<rule name="Ledge">
		<!--
		<operator name="copy">
			<param name="name" value="Wall"/>
		</operato>
		-->
		<operator name="size">
			<param name="xSize" type="relative" value="1"/>
			<param name="ySize" type="relative" value="0.9"/>
			<param name="zSize" type="absolute" value="0.2"/>
		</operator>
		<operator name="insert">
			<param name="geometryPath" value="cube"/>
		</operator>
		<operator name="copy">
			<param name="name" value="Wall"/>
		</operator>
	</rule>
	<rule name="Railing">
		<operator name="copy">
			<param name="name" value="HBar"/>
		</operator>
		<operator name="split">
			<param name="splitAxis" value="x"/>
			<param name="size">
				<element type="floating" value="tileW/3" repeat="true"/>
			</param>
			<param name="name">
				<element value="VBar"/>
			</param>
		</operator>
	</rule>
	<rule name="HBar">
		<operator name="translate">
			<param name="mode" value="rel"/>
			<param name="coordSystem" value="object"/>
			<param name="x" value="0"/>
			<param name="y" value="scope.sy-barDiameter/2"/>
			<param name="z" value="0"/>
		</operator>
		<operator name="size">
			<param name="xSize" type="relative" value="1"/>
			<param name="ySize" type="absolute" value="barDiameter"/>
			<param name="zSize" type="absolute" value="barDiameter"/>
		</operator>
		<operator name="translate">
			<param name="mode" value="rel"/>
			<param name="coordSystem" value="object"/>
			<param name="x" value="0"/>
			<param name="y" value="0"/>
			<param name="z" value="-barDiameter"/>
		</operator>
		<operator name="insert">
			<param name="geometryPath" value="cyl_h"/>
		</operator>
		<operator name="color">
			<param name="s" value="white"/>
		</operator>
	</rule>
	<rule name="VBar">
		<operator name="size">
			<param name="xSize" type="absolute" value="barDiameter"/>
			<param name="ySize" type="relative" value="1"/>
			<param name="zSize" type="absolute" value="barDiameter"/>
		</operator>
		<operator name="translate">
			<param name="mode" value="rel"/>
			<param name="coordSystem" value="object"/>
			<param name="x" value="0"/>
			<param name="y" value="0"/>
			<param name="z" value="-barDiameter"/>
		</operator>
		<operator name="insert">
			<param name="geometryPath" value="cyl_v"/>
		</operator>
		<operator name="color">
			<param name="s" value="white"/>
		</operator>
	</rule>
	<rule name="Bracing">
		<operator name="size">
			<param name="xSize" type="absolute" value="barDiameter"/>
			<param name="ySize" type="relative" value="1"/>
			<param name="zSize" type="absolute" value="0.15"/>
		</operator>
		<operator name="translate">
			<param name="mode" value="rel"/>
			<param name="coordSystem" value="object"/>
			<param name="x" value="barDiameter/2"/>
			<param name="y" value="0"/>
			<param name="z" value="0"/>
		</operator>
		<operator name="split">
			<param name="splitAxis" value="y"/>
			<param name="size">
				<element type="absolute" value="0.01"/>
				<element type="floating" value="1"/>
				<element type="absolute" value="0.01"/>
			</param>
			<param name="name">
				<element value="Wall"/>
				<element value="VBar"/>
				<element value="Wall"/>
			</param>
		</operator>
	</rule>
</rules>
